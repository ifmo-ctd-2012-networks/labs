## Build & Run
    mvn clean package
    java -jar target/Lab2.jar HOST_NAME PORT

## Протокол
Узел имеет 4 состояния:

Выполняется все время:
* Каждый узел отправляет соседям [PING] каждый timeout / 2.
* На принятый [PING] узел отправляет [PONG].
* Если на [PING] не пришел [PONG] в течение timeout, то узел считается неактивным.
* Если от неактивного узла пришло любое сообщение, то он считается активным.

Normal
1. Если узел j принимает [SEND_TOKEN token data op_number], то он сравнивает принятый op_number со своим.
	1a. Если больше, то сохраняет token, data, op_number и отправляет [RECEIVED token] - (принятие).
	1b. Иначе только отправляет [RECEIVED token] - (поглощение).
2. Если у узла есть токен, то он переходит в состояние Execute.
2. Иначе если количество активных узлов уменьшилось, то переходит в состояние View Changes.

Execute
1. Считаем PI.
2. Пересылка токена
	2a. Если есть активные соседи, то отправляем активному соседу [SEND_TOKEN token data].
	2b. Иначе переходим к пункту 1.
3. Ожидаем [RECEIVED token] в течение timeout. Если не получили, то возвращаемся к пункту 2.
3. Переходим в Normal.

View Changes
1. Узел i отправляет соседним узлам [START_VIEW_CHANGE i op_number].
2. Если узел j принимаeт [START_VIEW_CHANGE i op_number], то он сравнивает полученный view number со своим.
	2а. Если полученный view number больше или номер i < номера j, то узел отвечает [DO_VIEW_CHANGE j v].
	2b. Иначе узел отвечает [DISCARD_VIEW_CHANGE j vj], где vj - токен узла j.
3. Узел i ожидает сообщения в течение timeout.
	3а. Если узел i не получил ниодного сообщения, то он генерирует токен и переходит в состояние Normal.
	3b. Если узел i принимает хотя бы один [DISCARD_VIEW_CHANGE j vj], то запоминает vj.
	3с. Иначе он генерирует токен и переходит в состояние Normal.

Recovery
1. Узел i отправляет отправляет соседям [RECOVERY i x], где x - timestamp.
2. Узлы принимают [RECOVERY i x], только когда они находятся в состоянии Normal. 
3. Если узел j принял [RECOVERY i x], то он отправляет [RECOVERY_RESPONSE j data op_number x].
4. Узел i ожидает сообщения [RECOVERY_RESPONSE j data op_number x] в течение timeout. 
	4а. Если узел i не получил ниодного сообщения, то он переходит в состояние View Changes.
	4b.	Если все полученные op_number меньше его, то переходит в состояние Normal.
	4c. Иначе на основе полученных сообщений, узел запоминает наибольший op_number, данные соответствующие ему и переходит в состояние Normal.